{#
    This file is part of the nasza_nazwa project.

    nasza_nazwa is an educational platform for creating, branding, and solving quizzes made on behalf of the Sursum Corda association.
    It supports user authentication, quiz management, and result tracking, etc.

    The authors are:
        @author Beatrycze Piłat <beatrycze.pilat@gmail.com>
        @author Klara Szczerbińska <klaraszczerbinska@gmail.com>
        @author Marcelina Milc <marcelina.milc@gmail.com>
        @author Robert Rzeźniczek <r.rzezniczek19@gmail.com>
#}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Cześć!{% endblock %}</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text><text y=%221.3em%22 x=%220.2em%22 font-size=%2276%22 fill=%22%23fff%22>sf</text></svg>">

    {% block stylesheets %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,400;0,700;1,400&family=Luckiest+Guy&display=swap" rel="stylesheet">
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Jost', sans-serif;
                background: white;
                text-align: center;
                position: relative;
                min-height: 100vh;
                overflow-x: hidden;
            }
            main {
                padding-top: 120px;
            }

            header {
                display: flex;
                justify-content: flex-end;
                align-items: center;
                padding: 0;
                margin: 0;
                width: 100%;
                background: transparent;
            }

            .logo {
                position: fixed;
                top: 0;
                left: 0;
                z-index: 1000;
                padding: 0;
                margin: 0;
            }

            .logo img {
                display: block;
                width: clamp(120px, 19vw, 190px);
                height: auto;
            }

            /* === MENU BAR === */
            .menu-bar {
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 100%;
                max-width: 600px;
                margin-top: 0;
                padding: 0;
                background-color: transparent;
                box-shadow: none;
                border-radius: 0;
                order: 2;
                z-index: 1050;
            }
            .menu-bar a,
            .menu-button {
                display: block;
                padding: 11px 60px;
                border-radius: 40px;
                font-weight: bold;
                color: white;
                text-decoration: none;
                font-family: 'Luckiest Guy', cursive;
                transition: transform 0.2s ease;
                width: clamp(400px, 30vw, 650px);
                max-width: 600px;
                margin: 0 auto 20px auto;
                text-align: center;
                font-size: clamp(2.2rem, 6vw, 3.5rem);
                position: relative;
                z-index: 1;
                letter-spacing: 2px;
                white-space: nowrap;
            }
            .menu-bar a:hover,
            .menu-button:hover {
                transform: scale(1.05);
                z-index: 11;
            }
            .wyloguj {
                background-color: #d51b60;
                border: none !important;
                outline: none !important;
                box-shadow: none !important;
            }

            .wyloguj:hover {
                background-color: #b0154f;
                transform: scale(1.05);
                cursor: pointer;
            }

            .logout-btn-container {
                position: fixed;
                top: 80px; /* pod nawigacją */
                right: 20px;
                z-index: 1001;
            }

            .logout-btn {
                background-color: #d51b60;
                color: white;
                font-family: 'Luckiest Guy', cursive;
                border: none;
                padding: 12px 24px;
                font-size: 1.2rem;
                border-radius: 40px;
                transition: background 0.2s ease, transform 0.2s ease;
            }

            .logout-btn:hover {
                background-color: #b0154f;
                transform: scale(1.05);
                cursor: pointer;
            }

            /* === KOLORY PRZYCISKÓW === */
            .menu     { background-color: #c82123; }
            .zasady     { background-color: #f57c00; }
            .onas       { background-color: #fbc02d; }
            .faq        { background-color: #43a047; }
            .kontakt    { background-color: #039be5; }

            /* === SERDUSZKA === */
            footer {
                position: fixed;
                bottom: 10px;
                left: 10px;
                display: flex;
                align-items: center;
                gap: 10px;
            }

            .serduszka {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 400px;
                background-image: url('/images/serduszka.png');
                background-repeat: no-repeat;
                background-size: contain;
                background-position: bottom right;
                z-index: -10;
                pointer-events: none;
            }
            /* === MOBILE === */
            @media (max-width: 768px) {
                /* Ukryj menu domyślnie */
                .menu-bar {
                    display: none !important;
                    flex-direction: column;
                    background-color: #ffffff;
                    padding: 1rem;
                    position: fixed;
                    top: 60px;
                    right: 15px;
                    width: 85%;
                    max-width: 300px;
                    border-radius: 16px;
                    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
                    z-index: 1000;
                }

                .menu-bar.show {
                    display: flex !important;
                }

                .menu-bar a,
                .menu-button {
                    font-size: 1rem;
                    padding: 10px 20px;
                    border-radius: 12px;
                    width: 100%;
                    margin: 6px 0;
                }

                /* Hamburger */
                #mobileMenuToggle {
                    background-color: #8e24aa;
                    color: white;
                    border: none;
                    border-radius: 50%;
                    width: 48px;
                    height: 48px;
                    font-size: 20px;
                    line-height: 1;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    position: fixed;
                    top: 16px;
                    right: 16px;
                    z-index: 1100;
                    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
                    transition: background 0.2s ease;
                }

                #mobileMenuToggle:hover {
                    background-color: #9c27b0;
                }

                .main-btn,
                .menu-button {
                    margin-bottom: 10px;
                }

                .menu-button:last-child {
                    margin-bottom: 0;
                }
            }

            /* === DESKTOP === */
            @media (min-width: 769px) {
                #mobileMenuToggle {
                    display: none !important;
                }

                main {
                    margin-top: 20px;
                    align-items: center;
                }

                .logo {
                    margin-right: 0;
                }

                .logo img {
                    width: clamp(260px, 19vw, 200px);
                }

                .menu-bar {
                    display: flex !important;
                    flex-direction: row;
                    justify-content: flex-end;
                    gap: 12px;
                    max-width: 85vw;
                    position: fixed;
                    top: -5px;
                    right: 5px;
                    order: 0;
                }

                .menu-bar a,
                .menu-button {
                    padding: 13px clamp(10px, 6vw, 90px);
                    border-radius: 30px;
                    font-size: clamp(1.85rem, 4vw, 1.2rem);
                    width: clamp(400px, 30vw, 650px);
                    margin-bottom: 0;
                    margin-right: -50px;
                    position: relative;
                    white-space: nowrap;
                }

                .menu-button:nth-child(1) { z-index: 4; }
                .menu-button:nth-child(2) { z-index: 3; }
                .menu-button:nth-child(3) { z-index: 2; }
                .menu-button:nth-child(4) { z-index: 1; }
                .menu-button:nth-child(5) { z-index: 0; }


                .menu-button:hover {
                    z-index: 5;
                }

                .main-btn {
                    margin-top: 20px;
                    margin-bottom: 20px;
                }
            }
            #accessibilityPanel {
                position: fixed;
                top: 50%;
                left: -200px;
                transform: translateY(-50%);
                background: #fff;
                padding: 16px 12px;
                border-radius: 0 12px 12px 0;
                box-shadow: 4px 6px 15px rgba(0, 0, 0, 0.2);
                z-index: 1100;
                width: 180px;
                font-size: 14px;
                transition: left 0.4s ease;
                font-family: 'Jost', sans-serif;
                color: #333;
            }

            #accessibilityPanel.active {
                left: 0;
            }

            #accessibilityPanel strong {
                display: block;
                font-weight: bold;
                font-size: 18px;
                margin-bottom: 16px;
                text-align: center;
                color: #333;
                background: none;
                padding: 0;
            }

            #accessibilityPanel button {
                display: block;
                width: 100%;
                margin: 6px 0;
                padding: 10px 12px;
                font-size: 14px;
                font-weight: bold;
                border: none;
                border-radius: 30px;
                color: white;
                cursor: pointer;
                transition: transform 0.2s ease;
                font-family: 'Jost', sans-serif;
                text-align: center;
            }
            #accessibilityPanel button:nth-child(2) { background-color: #f9bf2d; } /* powiększ tekst */
            #accessibilityPanel button:nth-child(3) { background-color: #f37b00; } /* pomniejsz tekst */
            #accessibilityPanel button:nth-child(4) { background-color: #d04c34; } /* kontrast */
            #accessibilityPanel button:nth-child(5) { background-color: #d71b60; } /* jasne tło */
            #accessibilityPanel button:nth-child(6) { background-color: #8c24a8; } /* podkreślenie linków */
            #accessibilityPanel button:nth-child(7) { background-color: #0399e3; } /* RESET */
            #accessibilityPanel button:nth-child(8) { background-color: #439f47; } /* ZAMKNIJ */

            #accessibilityPanel button:hover {
                transform: scale(1.05);
                z-index: 10;
            }
            .hidden {
                display: none !important;
            }

            /* PRZYCISK OTWIERAJĄCY */
            #accessibilityToggleBtn {
                position: fixed;
                top: 50%;
                left: 0;
                transform: translateY(-50%);
                background-color: #8e24aa;
                color: white;
                border: none;
                width: 56px;
                height: 56px;
                border-radius: 0 16px 16px 0;
                cursor: pointer;
                z-index: 1110;
                font-size: 28px;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 3px 3px 8px rgba(0, 0, 0, 0.3);
                transition: background 0.2s ease;
            }

            #accessibilityToggleBtn:hover {
                background-color: #9c27b0;
            }

            .high-contrast {
                background-color: #000 !important;
                color: #fff !important;
            }

            .high-contrast a,
            .high-contrast button {
                background-color: #000 !important;
                color: #fff !important;
                border-color: #fff !important;
            }

            .underline-links a {
                text-decoration: underline !important;
            }

        </style>
    {% endblock %}
</head>
<button id="mobileMenuToggle" class="d-md-none btn btn-light position-fixed top-0 end-0 m-3 z-3">
    <i class="fas fa-bars"></i>
</button>

<body>
<main role="main" class="container-fluid">
    {# ... #}

    {# Nagłówek z logo i menu #}
    <header>
        <nav class="menu-bar">
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <a href="{{ path('app_menu') }}" class="menu-button menu">MENU</a>
            {% else %}
                <a href="{{ path('start_index') }}" class="menu-button menu">MENU</a>
            {% endif %}
            <a href="{{ path('app_rules') }}" class="menu-button zasady">ZASADY</a>
            <a href="https://www.sc.org.pl/o-nas/" class="menu-button onas" target="_blank" rel="noopener">O NAS</a>
            <a href="{{ path('app_faq') }}" class="menu-button faq">FAQ</a>
            <a href="{{ path('app_contact') }}" class="menu-button kontakt">KONTAKT</a>

            {# PRZYCISK WYLOGUJ - widoczny tylko na urządzeniach mobilnych #}
            {# W menu mobilnym — link wyglądający jak przycisk #}
            {% if is_granted('IS_AUTHENTICATED_FULLY') %}
                <a href="#" class="menu-button wyloguj d-md-none"
                   onclick="event.preventDefault(); document.getElementById('mobileLogoutForm').submit();">
                    {{ 'Wyloguj'|trans }}
                </a>
            {% endif %}

            {# Ukryty formularz wylogowania #}
            <form id="mobileLogoutForm" action="{{ path('app_logout') }}" method="post" class="d-md-none" style="display: none;"></form>
        </nav>

        {% include 'default/_flash_messages.html.twig' %}
    </header>

    {# PRZYCISK WYLOGUJ widoczny tylko na desktopie #}
    {% if is_granted('IS_AUTHENTICATED_FULLY') %}
        <div class="logout-btn-container d-none d-md-block">
            <form action="{{ path('app_logout') }}" method="post">
                <button type="submit" class="logout-btn">
                    {{ 'Wyloguj'|trans }}
                </button>
            </form>
        </div>
    {% endif %}

    <div class="logo">
        {% if is_granted('IS_AUTHENTICATED_FULLY') %}
        <a href="{{ path('app_menu') }}">
            {% else %}
            <a href="{{ path('start_index') }}">
                {% endif %}
                <img src="{{ asset('images/sursum-logo.png') }}" alt="Sursum Corda Logo">
            </a>
    </div>


    <!-- Przycisk otwierający -->
    <button id="accessibilityToggleBtn" title="Dostępność" aria-label="Panel dostępności">
        <i class="fas fa-universal-access"></i>
    </button>


    <!-- Panel dostępności -->
    <div id="accessibilityPanel" aria-label="Panel dostępności" role="region">
        <strong>Dostępność</strong>
        <button onclick="changeTextSize('increase')">Powiększ tekst</button>
        <button onclick="changeTextSize('decrease')">Pomniejsz tekst</button>
        <button onclick="toggleClass('high-contrast')">Kontrast</button>
        <button onclick="toggleClass('light-bg')">Jasne tło</button>
        <button onclick="toggleClass('underline-links')">Podkreślenie linków</button>
        <button onclick="resetAccessibility()">Reset</button>
        <button id="closeAccessibilityBtn">Zamknij</button>
    </div>


    <script>
        const panel = document.getElementById('accessibilityPanel');
        const toggleBtn = document.getElementById('accessibilityToggleBtn');
        const closeBtn = document.getElementById('closeAccessibilityBtn');

        toggleBtn.addEventListener('click', () => {
            panel.classList.add('active');
            toggleBtn.classList.add('hidden'); // Ukryj przycisk ☰ po kliknięciu
        });

        closeBtn.addEventListener('click', () => {
            panel.classList.remove('active');
            toggleBtn.classList.remove('hidden'); // Pokaż przycisk ☰ po zamknięciu
        });

        let currentFontSize = 1;

        function changeTextSize(direction) {
            if (direction === 'increase' && currentFontSize < 2) {
                currentFontSize += 0.1;
            } else if (direction === 'decrease' && currentFontSize > 0.7) {
                currentFontSize -= 0.1;
            }
            document.body.style.fontSize = currentFontSize + 'em';
        }

        function toggleClass(className) {
            document.body.classList.toggle(className);
        }

        function resetAccessibility() {
            currentFontSize = 1;
            document.body.style.fontSize = '';
            document.body.classList.remove(
                'grayscale',
                'high-contrast',
                'light-bg',
                'underline-links'
            );
            document.body.style.backgroundColor = '';
            document.body.style.color = '';
        }
        const mobileToggleBtn = document.getElementById('mobileMenuToggle');
        const menuBar = document.querySelector('.menu-bar');

        mobileToggleBtn.addEventListener('click', () => {
            menuBar.classList.toggle('show');
        });

    </script>

    </div>

    {% block body %}{% endblock %}
    <div class="serduszka"></div>

    {# ... #}
</main>
{% block javascripts %}
    {# {% block importmap %}{{ importmap('app') }}{% endblock %} #}
    <script
            src="https://code.jquery.com/jquery-3.7.1.slim.min.js"
            integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8="
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            crossorigin="anonymous"></script>
{% endblock %}
</body>
</html>